CURDIR = .
GOPATH = $(CURDIR)/go
GOFMT = go fmt
GOBUILD = go build
GOCLEAN = go clean
CXX_STD = CXX11
CCACHE_CPP2 = yes
CXX = ccache g++
PKG_CPPFLAGS += -I'$(CURDIR)'
PKG_CXXFLAGS += -DRCPP_PARALLEL_USE_TBB=1 -DDLL_IMPORT
PKG_LIBS += -L$(CURDIR) -lm -llibkagome
LDFLAGS += $(PKG_LIBS) $(SHLIB_LIBADD) $(LIBR)

.PHONY: all

all: build clean

build:
	rm -f ../inst/include/libkagome.h
	$(GOFMT) github.com/paithiov909/cmd/libkagome
	CXX="$(CXX11)" GOPATH="$(GOPATH)" CGO_ENABLED=1 $(GOBUILD) -o libkagome$(SHLIB_EXT) -i -a -x -compiler gc -buildmode=c-shared github.com/paithiov909/cmd/libkagome

clean:
	cp libkagome.h ../inst/include/
	$(GOCLEAN) -i -x
